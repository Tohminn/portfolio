<div class="content" ng-controller="CreateStudyController as createStudyCtrl">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-4" style="height: 214px;border-right: 2px dashed #eee;">
                <h4 class="text-center" style="margin-bottom: 0px;font-size: 22px;">Step 1</h4>
                <div class="row">
                    <div class="col-md-2">
                        <svg id="studyTypeSvg" class="circular-loader" viewBox="0 0 24 24" height="60px" width="60px">
                            <rect x="3" y="3" rx="2" ry="2" fill="dodgerblue" height="18" width="18"/>
                            <circle cx="12" cy="12" r="6" stroke="#ffffff" stroke-width="2" fill="none"></circle>
                        </svg>
                    </div>
                    <div class="col-md-10 text-center">
                        <label class="btn btn-default input-lg details-btn" ng-click="createStudyCtrl.setStudyType()">
                            <span style="font-size: 20px;">Set Study Details</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <svg id="classificationSvg" class="circular-loader" viewBox="0 0 24 24" height="60px" width="60px">
                            <rect x="3" y="3" rx="2" ry="2" fill="dodgerblue" height="18" width="18"/>
                            <circle cx="12" cy="12" r="6" stroke="#ffffff" stroke-width="2" fill="none"></circle>
                        </svg>
                    </div>
                    <div class="col-md-10 text-center">
                        <label class="btn btn-default input-lg details-btn" ng-click="createStudyCtrl.setClassificationDetails()">
                            <span style="font-size: 20px;">Set Classification Details</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <svg id="dateReportSvg" class="circular-loader" viewBox="0 0 24 24" height="60px" width="60px">
                            <rect x="3" y="3" rx="2" ry="2" fill="dodgerblue" height="18" width="18"/>
                            <circle cx="12" cy="12" r="6" stroke="#ffffff" stroke-width="2" fill="none"></circle>
                        </svg>
                    </div>
                    <div class="col-md-10 text-center">
                        <label class="btn btn-default input-lg details-btn" ng-click="createStudyCtrl.setDateAndReportDetails()">
                            <span style="font-size: 20px;">Set Date and Time Details</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="col-md-5" style="border-right: 2px dashed #eee;">
                <h4 class="text-center" style="margin-bottom: 0px;font-size: 22px;">Step 2</h4>
                <div class="content" style="height: 5em;padding-top: 7px;">
                    <input class="form-control input-lg" required type="text" maxlength="100"  ng-model="studyName" placeholder="*Please Name This Study" >
                </div>
                <div class="row" style="height: 110px;">
                    <div class="col-md-12">
                        <div ngf-drop ngf-select ng-model="files" class="drop-box" ngf-drag-over-class="'dragover'" ngf-multiple="true" ngf-allow-dir="true" accept="video/*" ngf-pattern="'video/*'">
                            <br>Drop Video Files or Click Here
                            <div style="font-size: 12px;vertical-align: text-top;padding-top: 18px;">*Chrome users can drop folders of videos too!</div>
                        </div>
                        <div ngf-no-file-drop>
                            <button class="btn btn-default input-lg" style="margin-top: 30px;" ngf-select="addFiles(files)" ngf-multiple="true">
                                Select Video Files
                            </button>
                            <p style="color:red;">File Drag/Drop is not supported for this browser</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <h4 class="text-center" style="margin-bottom: 0px;font-size: 22px;">Step 3</h4>
                <div class="row text-center" style="padding-top: 7px;">
                    <div class="col-md-10" style="padding-right: 5px;">
                        <div class="well" style="min-height: 103px;margin-bottom: 0px;padding: 6px 12px;height: 103px;overflow-y: scroll;overflow-x: hidden;">
                            <div ng-show="attachments.length > 0">
                                <div ng-repeat="attachment in attachments track by $index">
                                    <div class="row">
                                        <div class="col-sm-10 text-left" style="padding-right: 0px;padding-top:5px;">
                                            <span ng-if="attachment.name.length < 25">
                                                {{attachment.name}}
                                            </span>
                                            <span ng-if="attachment.name.length >= 25">
                                                {{attachment.name.substring(0,25)}}...
                                            </span>
                                        </div>
                                        <div class="col-sm-2" style="padding: 0px;">
                                            <label class="btn btn-default" style="padding: 6px 5px;padding-left: 3px;padding-bottom: 3px;" ng-click="removeAttachment($index)">
                                                <span class="glyphicon glyphicon-trash"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <hr style="border-color: black;margin-top: 3px;margin-bottom: 3px;">
                                </div>
                            </div>
                            <div ng-hide="attachments.length > 0" class="text-center">
                                <span style="color: gray;">
                                    Add Attachments -->
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2" style="padding-left: 0px;">
                        <div ngf-drop ngf-select ng-model="attachmentSelect" class="btn btn-default" ngf-drag-over-class="'dragover'" ngf-multiple="true" ngf-allow-dir="true">
                            <span class="glyphicon glyphicon-paperclip"></span>
                        </div>
                    </div>
                </div>
                <div class="row text-center" style="padding-top: 15px;">
                    <input type="submit" id="submitButton" class="btn btn-primary input-lg" style="width: 165px;" value="Submit" 
                    ng-disabled="videoCameras.length === 0 || studyType === undefined || classification === undefined || dateTime === undefined || report === undefined || studyName.length == 0"
                    ng-click="createStudyCtrl.submitStudy()" />
                </div>
            </div>
        </div>
    </div>
    <hr style="border-top: 5px solid #eee;" ng-show="videoCameras.length == 0">
    <div class="container-fluid">
        <div class="row" style="margin-top: 20px;">
            <div class="col-md-12" style="padding: 0px;" ng-repeat="camera in videoCameras track by $index" ng-init="cameraIndex = $index">
                <div class="panel panel-default panel-heading" style="margin-bottom: 0px;cursor: pointer;padding-bottom: 0px;" ng-if="studyType.roadType != 'other' && studyType.cameraCount >  1" ng-click="isCollapsed[cameraIndex].camera = !isCollapsed[cameraIndex].camera">
                    <h4 class="panel-title text-center">Camera {{cameraIndex + 1}}</h4>
                    <div class="text-center" style="color: #a9a9a9;font-size: 12px;">Click to Collapse</div>
                </div>
                <div class="row well dropzone" uib-collapse="isCollapsed[cameraIndex].camera">
                    <div class="col-md-12" ng-repeat="timePeriod in camera track by $index" ng-init="timePeriodIndex = $index">
                        <div class="panel panel-default panel-heading" style="margin-bottom: 0px;cursor: pointer;padding-bottom: 0px;margin-left: -15px;margin-right: -15px;" 
                            ng-if="dateTime && dateTime.timePeriods.length >  1" 
                            ng-click="isCollapsed[cameraIndex].timePeriod[timePeriodIndex] = !isCollapsed[cameraIndex].timePeriod[timePeriodIndex]">
                            <h4 class="panel-title text-center">Time Period {{dateTime.timePeriods[timePeriodIndex].startTime}} - {{dateTime.timePeriods[timePeriodIndex].endTime}}</h4>
                            <div class="text-center" style="color: #a9a9a9;font-size: 12px;">Click to Collapse</div>
                        </div>
                        <div class="row dropzone" ng-class="(dateTime.timePeriods.length > 1) ? 'well inner-well' : ''"
                            uib-collapse="isCollapsed[cameraIndex].timePeriod[timePeriodIndex]">
                            <ul dnd-list="cameraFiles" 
                                dnd-horizontal-list="true" 
                                dnd-drop="dropCallback(index, item, external, type)"
                                dnd-allowed-types="['cam{{cameraIndex}}_tp{{timePeriodIndex}}']">
                                <li ng-repeat="file in timePeriod track by $index" 
                                    dnd-draggable="file"
                                    dnd-type="'cam{{cameraIndex}}_tp{{timePeriodIndex}}'"
                                    dnd-effect-allowed="move"
                                    dnd-moved="dragMoved(cameraIndex, timePeriodIndex, $index)"
                                    class="col-md-4">
                                    <div class="card fileCard">
                                        <div class="content">
                                            <div class="row">
                                                <div class="col-md-2 text-left">
                                                    <svg width="50" height="50" viewBox="0 0 50 50">
                                                        <circle cx="25" cy="25" r="23" stroke="#337ab7" stroke-width="2" fill="lightgray"></circle>
                                                        <text font-size="26" fill="white" font-family="Verdana" text-anchor="middle" alignment-baseline="baseline" x="24" y="32.4">
                                                            {{$index + 1}}
                                                        </text>
                                                    </svg>
                                                </div>
                                                <div class="col-md-10" style="padding-left: 8px;">
                                                    <input class="form-control input-sm" required type="text" maxlength="100"  ng-model="file.name" placeholder="File Name" dnd-nodrag>
                                                    <div class="row">
                                                        <div class="col-md-offset-1 col-md-5">
                                                            <b>Size: </b>{{file.size}} Mb
                                                        </div>
                                                        <div class="col-md-6">
                                                            <b>Type: </b>{{file.file.type}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-bottom: 5px;">
                                                <div class="col-md-2"></div>
                                                <div class="col-md-5 text-center" ng-show="studyType.roadType != 'other' && studyType.cameraCount >  1">
                                                    <b>Camera: &nbsp;&nbsp;&nbsp;</b>
                                                    <select ng-model="file.camera" ng-options="possibleCamera for possibleCamera in possibleCameras" ng-change="createStudyCtrl.changedCamera(cameraIndex, timePeriodIndex, $index)"></select>
                                                </div>
                                                <div class="col-md-5 text-center" ng-show="dateTime && dateTime.timePeriods.length > 1">
                                                    <b>Time Period:</b>
                                                    <select ng-model="file.timePeriod" 
                                                        ng-options="tpIndex*1 as (timePeriod.startTime+'-'+timePeriod.endTime) for (tpIndex, timePeriod) in dateTime.timePeriods" 
                                                        ng-change="createStudyCtrl.changedTimePeriod(cameraIndex, timePeriodIndex, $index)"
                                                    ></select>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-offset-1 col-md-10" id="video_{{$index}}">
                                                    <video ngf-src="file.file" style="width: 100%;height: auto;" controls muted dnd-nodrag></video>
                                                </div>
                                            </div>
                                            <div class="footer text-center">
                                                <hr>
                                                <label class="btn btn-default text-center" style="float: left;color: #333;" ng-click="removeVideo(cameraIndex, timePeriodIndex, $index)">
                                                    <span class="glyphicon glyphicon-trash"></span>
                                                </label>
                                                <div class="stats">
                                                    Click and Drag to Reorder Files
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div><br><br><br><br><br><br></div>
</div>
<style type="text/css">
    #submitButton[disabled] {
        background-color: #337ab7;
    }
    .inner-well {
        padding-left: 0px;
        padding-right: 0px;
        background-color: #e6e6e6;
    }
    .drop-box {
        background: #F8F8F8;
        border: 5px dashed #e6e6e6;
        height: 100px;
        text-align: center;
        margin: 0px;
    }
    .dragover {
        border: 5px dashed blue;
    }

    .dropzone ul[dnd-list] {
        margin: 0px;
        min-height: 42px;
        padding-left: 0px;
    }

    .dropzone li {
        display: block;
        min-height: 348px;
    }

    .dropzone .dndDragging {
        opacity: 0.7;
    }

    .dropzone .dndDraggingSource {
        display: none;
    }

    .dropzone .dndPlaceholder {
        background-color: #ddd;
        display: block;
        min-height: 348px;
    }

    .details-btn {
        margin-top: 7px;
        border-style: outset;
        border-width: medium;
        width: 100%;
    }

    .loader-path {
        stroke-dasharray: 150,200;
        stroke-dashoffset: -10;
        -webkit-animation: dash 1.5s ease-in-out infinite, color 6s ease-in-out infinite;
                animation: dash 1.5s ease-in-out infinite, color 6s ease-in-out infinite;
        stroke-linecap: round;
    }

    @-webkit-keyframes dash {
        0% {
            stroke-dasharray: 1,200;
            stroke-dashoffset: 0;
        }
        50% {
            stroke-dasharray: 89,200;
            stroke-dashoffset: -35;
        }
        100% {
            stroke-dasharray: 89,200;
            stroke-dashoffset: -124;
        }
    }
    @keyframes dash {
        0% {
            stroke-dasharray: 1,200;
            stroke-dashoffset: 0;
        }
        50% {
            stroke-dasharray: 89,200;
            stroke-dashoffset: -35;
        }
        100% {
            stroke-dasharray: 89,200;
            stroke-dashoffset: -124;
        }
    }
</style>